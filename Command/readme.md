## 命令模式

### 定义

将请求封装为对象，从而允许您使用不同的请求，队列或日志请求参数化客户端，并支持可撤销操作。

![Command](https://raw.githubusercontent.com/Jximing/git_resources/master/pictures/Command.jpg)

### 应用

当下列情形的时候你应该使用命令模式

- 将程序的执行参数化，可以理解为面向过程语言里面的回调函数，将方法注册到某个地方在之后被调用。命令模式是面向对象语言里面的回调函数。
- 指定队列和请求在不同的时间执行。Command对象的生命周期可以独立于原始请求。如果请求的接收者可以以与地址空间无关的方式表示，那么您可以将请求的命令对象传输到另一个进程并在那里完成请求。
- 支持撤消。 Command对象的执行操作可以存储状态以在对象本身中来达到撤销操作的效果。Command接口必须具有添加的Unexecute操作，该操作可以反转先前执行调用的影响。执行的命令存储在历史列表中。通过遍历此列表并分别转发调用unexecute和execute来实现无限级别的撤销和重做。
- 支持日志记录更改，以便在系统崩溃时可以重新应用它们。通过使用加载和存储操作扩充Command接口，您可以保留持久的更改日志。从崩溃中恢复涉及从磁盘重新加载已记录的命令并使用执行操作重新执行它们。
- 用低级操作来构造高级操作。这样一种结构在支持事务的信息系统中很常见。事务封装了一组对数据的更改。命令有一个通用接口，允许您以相同的方式调用所有事务。该模式还可以使用新事务扩展系统。



### 经典实用场景

- 保留请求日志
- 实现方法的回滚
- 实现撤销操作